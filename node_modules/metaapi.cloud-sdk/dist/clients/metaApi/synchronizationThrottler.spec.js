'use strict';

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

var _synchronizationThrottler = require('./synchronizationThrottler');

var _synchronizationThrottler2 = _interopRequireDefault(_synchronizationThrottler);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @test {SynchronizationThrottler}
 */
describe('SynchronizationThrottler', () => {
  let throttler, clock, sandbox, websocketClient;

  before(() => {
    sandbox = _sinon2.default.createSandbox();
  });

  beforeEach(() => {
    clock = _sinon2.default.useFakeTimers({
      now: new Date('2020-10-05T10:00:00.000Z'),
      shouldAdvanceTime: true
    });
    websocketClient = {
      _rpcRequest: (accountId, request, timeoutInSeconds) => {},
      subscribedAccountIds: () => new Array(11),
      socketInstances: [{ synchronizationThrottler: { synchronizingAccounts: [] } }]
    };
    websocketClient._rpcRequest = sandbox.stub();
    throttler = new _synchronizationThrottler2.default(websocketClient, 0);
    throttler.start();
  });

  afterEach(() => {
    clock.restore();
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should immediately send request if free slots exist', async () => {
    await throttler.scheduleSynchronize('accountId', { requestId: 'test' });
    _sinon2.default.assert.match(throttler._synchronizationIds, { test: 1601892000000 });
    throttler.removeSynchronizationId('test');
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test' });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not remove sync if different instance index', async () => {
    await throttler.scheduleSynchronize('accountId', { requestId: 'test', instanceIndex: 0 });
    await throttler.scheduleSynchronize('accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.match(throttler._synchronizationIds, { test: 1601892000000, test1: 1601892000000 });
    throttler.removeSynchronizationId('test', 0);
    _sinon2.default.assert.match(throttler._synchronizationIds, { test1: 1601892000000 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should wait for other sync requests to finish if slots are full', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should increase slot amount with more subscribed accounts', async () => {
    websocketClient.subscribedAccountIds = () => new Array(21);
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    await throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test3' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should set hard limit for concurrent synchronizations across throttlers via options', async () => {
    websocketClient.subscribedAccountIds = () => new Array(21);
    throttler = new _synchronizationThrottler2.default(websocketClient, 0, { maxConcurrentSynchronizations: 3 });
    websocketClient.socketInstances = [{ synchronizationThrottler: throttler }, { synchronizationThrottler: { synchronizingAccounts: ['accountId4'] } }];
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not take extra slots if sync ids belong to the same account', async () => {
    throttler.scheduleSynchronize('accountId', { requestId: 'test', instanceIndex: 0 });
    throttler.scheduleSynchronize('accountId', { requestId: 'test1', instanceIndex: 1 });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#_removeOldSyncIdsJob}
   */
  it('should clear expired synchronization slots if no packets for 10 seconds', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    await clock.tickAsync(11000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#updateSynchronizationId}
   */
  it('should renew sync on update', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    await clock.tickAsync(11000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    await clock.tickAsync(11000);
    throttler.updateSynchronizationId('test1');
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should replace previous syncs', async () => {
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test5' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test3', instanceIndex: 0 });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#onDisconnect}
   */
  it('should clear existing sync ids on disconnect', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.onDisconnect();
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#_removeFromQueue}
   */
  it('should remove synchronizations from queue', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test4', instanceIndex: 0 });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test5' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test6' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test7' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test8' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test9' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test10', instanceIndex: 0 });
    await clock.tickAsync(53000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 6);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test8' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test10', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId4', { requestId: 'test7' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId5', { requestId: 'test9' });
  });

  /**
   * @test {SynchronizationThrottler#_removeOldSyncIdsJob}
   */
  it('should remove expired synchronizations from queue', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    for (let i = 0; i < 20; i++) {
      await clock.tickAsync(8000);
      throttler.updateSynchronizationId('test1');
      throttler.updateSynchronizationId('test2');
    }
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    for (let i = 0; i < 20; i++) {
      await clock.tickAsync(8000);
      throttler.updateSynchronizationId('test1');
      throttler.updateSynchronizationId('test2');
    }
    await clock.tickAsync(33000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId5', { requestId: 'test5' });
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not get queue stuck due to app synchronizations limit', async () => {
    throttler._client.socketInstances = [{ synchronizationThrottler: { synchronizingAccounts: ['accountId21', 'accountId22', 'accountId23', 'accountId24', 'accountId25', 'accountId26', 'accountId27', 'accountId28', 'accountId29', 'accountId210', 'accountId211', 'accountId212', 'accountId213', 'accountId214', 'accountId215'] } }, { synchronizationThrottler: throttler }];
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await clock.tickAsync(5000);
    _sinon2.default.assert.notCalled(websocketClient._rpcRequest);
    throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts = throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts.slice(1);
    await clock.tickAsync(5000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 1);
    throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts = throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts.slice(1);
    await clock.tickAsync(5000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
  });

  /**
   * @test {SynchronizationThrottler#removeSynchronizationId}
   */
  it('should not skip queue items when synchronization id is removed', async () => {
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    await clock.tickAsync(2000);
    throttler.removeSynchronizationId('test3');
    await clock.tickAsync(2000);
    throttler.removeSynchronizationId('test1');
    throttler.removeSynchronizationId('test2');
    await clock.tickAsync(2000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#removeIdByParameters}
   */
  it('should remove id by parameters', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2', instanceIndex: 0, host: 'ps-mpa-0' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test4', instanceIndex: 1, host: 'ps-mpa-1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test5', instanceIndex: 0, host: 'ps-mpa-2' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test6' });
    await new _promise2.default(res => setTimeout(res, 50));
    throttler.removeIdByParameters('accountId2', 0, 'ps-mpa-0');
    throttler.removeIdByParameters('accountId2', 1, 'ps-mpa-1');
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 50));
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test3' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test5', instanceIndex: 0,
      host: 'ps-mpa-2' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jbGllbnRzL21ldGFBcGkvc3luY2hyb25pemF0aW9uVGhyb3R0bGVyLnNwZWMuZXM2Il0sIm5hbWVzIjpbImRlc2NyaWJlIiwidGhyb3R0bGVyIiwiY2xvY2siLCJzYW5kYm94Iiwid2Vic29ja2V0Q2xpZW50IiwiYmVmb3JlIiwic2lub24iLCJjcmVhdGVTYW5kYm94IiwiYmVmb3JlRWFjaCIsInVzZUZha2VUaW1lcnMiLCJub3ciLCJEYXRlIiwic2hvdWxkQWR2YW5jZVRpbWUiLCJfcnBjUmVxdWVzdCIsImFjY291bnRJZCIsInJlcXVlc3QiLCJ0aW1lb3V0SW5TZWNvbmRzIiwic3Vic2NyaWJlZEFjY291bnRJZHMiLCJBcnJheSIsInNvY2tldEluc3RhbmNlcyIsInN5bmNocm9uaXphdGlvblRocm90dGxlciIsInN5bmNocm9uaXppbmdBY2NvdW50cyIsInN0dWIiLCJTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIiLCJzdGFydCIsImFmdGVyRWFjaCIsInJlc3RvcmUiLCJpdCIsInNjaGVkdWxlU3luY2hyb25pemUiLCJyZXF1ZXN0SWQiLCJhc3NlcnQiLCJtYXRjaCIsIl9zeW5jaHJvbml6YXRpb25JZHMiLCJ0ZXN0IiwicmVtb3ZlU3luY2hyb25pemF0aW9uSWQiLCJjYWxsZWRXaXRoIiwiaW5zdGFuY2VJbmRleCIsInRlc3QxIiwicmVzIiwic2V0VGltZW91dCIsImNhbGxDb3VudCIsIm1heENvbmN1cnJlbnRTeW5jaHJvbml6YXRpb25zIiwidGlja0FzeW5jIiwidXBkYXRlU3luY2hyb25pemF0aW9uSWQiLCJvbkRpc2Nvbm5lY3QiLCJpIiwiX2NsaWVudCIsIm5vdENhbGxlZCIsInNsaWNlIiwiaG9zdCIsInJlbW92ZUlkQnlQYXJhbWV0ZXJzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQTs7O0FBR0FBLFNBQVMsMEJBQVQsRUFBcUMsTUFBTTtBQUN6QyxNQUFJQyxTQUFKLEVBQWVDLEtBQWYs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N0MsRUFBNUM7QUFDQWhELGNBQVUyQixtQkFBVixDQUE4QixZQUE5QixFQUE0QyxFQUFDQyxXQUFXLE9BQVosRUFBcUJPLGVBQWUsQ0FBcEMsRUFBdUNhLE1BQU0sVUFBN0MsRUFBNUM7QUFDQWhELGNBQVUyQixtQkFBVixDQUE4QixZQUE5QixFQUE0QyxFQUFDQyxXQUFXLE9BQVosRUFBNUM7QUFDQSxVQUFNLHNCQUFZUyxPQUFPQyxXQUFXRCxHQUFYLEVBQWdCLEVBQWhCLENBQW5CLENBQU47QUFDQXJDLGNBQVVpRCxvQkFBVixDQUErQixZQUEvQixFQUE2QyxDQUE3QyxFQUFnRCxVQUFoRDtBQUNBakQsY0FBVWlELG9CQUFWLENBQStCLFlBQS9CLEVBQTZDLENBQTdDLEVBQWdELFVBQWhEO0FBQ0FqRCxjQUFVaUMsdUJBQVYsQ0FBa0MsT0FBbEM7QUFDQSxVQUFNLHNCQUFZSSxPQUFPQyxXQUFXRCxHQUFYLEVBQWdCLEVBQWhCLENBQW5CLENBQU47QUFDQWhDLG9CQUFNd0IsTUFBTixDQUFhSyxVQUFiLENBQXdCL0IsZ0JBQWdCUyxXQUF4QyxFQUFxRCxZQUFyRCxFQUFtRSxFQUFDZ0IsV0FBVyxPQUFaLEVBQW5FO0FBQ0F2QixvQkFBTXdCLE1BQU4sQ0FBYUssVUFBYixDQUF3Qi9CLGdCQUFnQlMsV0FBeEMsRUFBcUQsWUFBckQsRUFBbUUsRUFBQ2dCLFdBQVcsT0FBWixFQUFxQk8sZUFBZSxDQUFwQztBQUNqRWEsWUFBTSxVQUQyRCxFQUFuRTtBQUVBM0Msb0JBQU13QixNQUFOLENBQWFVLFNBQWIsQ0FBdUJwQyxnQkFBZ0JTLFdBQXZDLEVBQW9ELENBQXBEO0FBQ0QsR0FoQkQ7QUFrQkQsQ0EvUkQiLCJmaWxlIjoic3luY2hyb25pemF0aW9uVGhyb3R0bGVyLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3luY2hyb25pemF0aW9uVGhyb3R0bGVyIGZyb20gJy4vc3luY2hyb25pemF0aW9uVGhyb3R0bGVyJztcbmltcG9ydCBzaW5vbiBmcm9tICdzaW5vbic7XG5cbi8qKlxuICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlcn1cbiAqL1xuZGVzY3JpYmUoJ1N5bmNocm9uaXphdGlvblRocm90dGxlcicsICgpID0+IHtcbiAgbGV0IHRocm90dGxlciwgY2xvY2ssIHNhbmRib3gsIHdlYnNvY2tldENsaWVudDtcblxuICBiZWZvcmUoKCkgPT4ge1xuICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KCk7XG4gIH0pO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGNsb2NrID0gc2lub24udXNlRmFrZVRpbWVycyh7XG4gICAgICBub3c6IG5ldyBEYXRlKCcyMDIwLTEwLTA1VDEwOjAwOjAwLjAwMFonKSxcbiAgICAgIHNob3VsZEFkdmFuY2VUaW1lOiB0cnVlXG4gICAgfSk7XG4gICAgd2Vic29ja2V0Q2xpZW50ID0ge1xuICAgICAgX3JwY1JlcXVlc3Q6IChhY2NvdW50SWQsIHJlcXVlc3QsIHRpbWVvdXRJblNlY29uZHMpID0+IHt9LFxuICAgICAgc3Vic2NyaWJlZEFjY291bnRJZHM6ICgpID0+IG5ldyBBcnJheSgxMSksXG4gICAgICBzb2NrZXRJbnN0YW5jZXM6IFt7c3luY2hyb25pemF0aW9uVGhyb3R0bGVyOiB7c3luY2hyb25pemluZ0FjY291bnRzOiBbXX19XSxcbiAgICB9OyAgXG4gICAgd2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0ID0gc2FuZGJveC5zdHViKCk7XG4gICAgdGhyb3R0bGVyID0gbmV3IFN5bmNocm9uaXphdGlvblRocm90dGxlcih3ZWJzb2NrZXRDbGllbnQsIDApO1xuICAgIHRocm90dGxlci5zdGFydCgpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGNsb2NrLnJlc3RvcmUoKTtcbiAgfSk7XG4gICAgXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIGltbWVkaWF0ZWx5IHNlbmQgcmVxdWVzdCBpZiBmcmVlIHNsb3RzIGV4aXN0JywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdCd9KTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt0ZXN0OiAxNjAxODkyMDAwMDAwfSk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0Jyk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkJywge3JlcXVlc3RJZDogJ3Rlc3QnfSk7XG4gICAgc2lub24uYXNzZXJ0Lm1hdGNoKHRocm90dGxlci5fc3luY2hyb25pemF0aW9uSWRzLCB7fSk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIG5vdCByZW1vdmUgc3luYyBpZiBkaWZmZXJlbnQgaW5zdGFuY2UgaW5kZXgnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0JywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdDEnLCBpbnN0YW5jZUluZGV4OiAxfSk7XG4gICAgc2lub24uYXNzZXJ0Lm1hdGNoKHRocm90dGxlci5fc3luY2hyb25pemF0aW9uSWRzLCB7dGVzdDogMTYwMTg5MjAwMDAwMCwgdGVzdDE6IDE2MDE4OTIwMDAwMDB9KTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QnLCAwKTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt0ZXN0MTogMTYwMTg5MjAwMDAwMH0pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0JywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0MScsIGluc3RhbmNlSW5kZXg6IDF9KTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt9KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgd2FpdCBmb3Igb3RoZXIgc3luYyByZXF1ZXN0cyB0byBmaW5pc2ggaWYgc2xvdHMgYXJlIGZ1bGwnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMik7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMyk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIGluY3JlYXNlIHNsb3QgYW1vdW50IHdpdGggbW9yZSBzdWJzY3JpYmVkIGFjY291bnRzJywgYXN5bmMgKCkgPT4ge1xuICAgIHdlYnNvY2tldENsaWVudC5zdWJzY3JpYmVkQWNjb3VudElkcyA9ICgpID0+IG5ldyBBcnJheSgyMSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDMpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNzY2hlZHVsZVN5bmNocm9uaXplfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCBzZXQgaGFyZCBsaW1pdCBmb3IgY29uY3VycmVudCBzeW5jaHJvbml6YXRpb25zIGFjcm9zcyB0aHJvdHRsZXJzIHZpYSBvcHRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgIHdlYnNvY2tldENsaWVudC5zdWJzY3JpYmVkQWNjb3VudElkcyA9ICgpID0+IG5ldyBBcnJheSgyMSk7XG4gICAgdGhyb3R0bGVyID0gbmV3IFN5bmNocm9uaXphdGlvblRocm90dGxlcih3ZWJzb2NrZXRDbGllbnQsIDAsIHttYXhDb25jdXJyZW50U3luY2hyb25pemF0aW9uczogM30pO1xuICAgIHdlYnNvY2tldENsaWVudC5zb2NrZXRJbnN0YW5jZXMgPSBbe3N5bmNocm9uaXphdGlvblRocm90dGxlcjogdGhyb3R0bGVyfSxcbiAgICAgIHtzeW5jaHJvbml6YXRpb25UaHJvdHRsZXI6IHtzeW5jaHJvbml6aW5nQWNjb3VudHM6IFsnYWNjb3VudElkNCddfX1dO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q0J30pO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMik7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMyk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIG5vdCB0YWtlIGV4dHJhIHNsb3RzIGlmIHN5bmMgaWRzIGJlbG9uZyB0byB0aGUgc2FtZSBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdCcsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkJywge3JlcXVlc3RJZDogJ3Rlc3QxJywgaW5zdGFuY2VJbmRleDogMX0pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdCcsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdDEnLCBpbnN0YW5jZUluZGV4OiAxfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt9KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjX3JlbW92ZU9sZFN5bmNJZHNKb2J9XG4gICAqL1xuICBpdCgnc2hvdWxkIGNsZWFyIGV4cGlyZWQgc3luY2hyb25pemF0aW9uIHNsb3RzIGlmIG5vIHBhY2tldHMgZm9yIDEwIHNlY29uZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAyKTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoMTEwMDApO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjdXBkYXRlU3luY2hyb25pemF0aW9uSWR9XG4gICAqL1xuICBpdCgnc2hvdWxkIHJlbmV3IHN5bmMgb24gdXBkYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMik7XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDExMDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMyk7XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDExMDAwKTtcbiAgICB0aHJvdHRsZXIudXBkYXRlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QxJyk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDQnLCB7cmVxdWVzdElkOiAndGVzdDQnfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDUnLCB7cmVxdWVzdElkOiAndGVzdDUnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCA0KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgcmVwbGFjZSBwcmV2aW91cyBzeW5jcycsIGFzeW5jICgpID0+IHtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0NCd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MycsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDIwKSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDQpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNvbkRpc2Nvbm5lY3R9XG4gICAqL1xuICBpdCgnc2hvdWxkIGNsZWFyIGV4aXN0aW5nIHN5bmMgaWRzIG9uIGRpc2Nvbm5lY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAyKTtcbiAgICB0aHJvdHRsZXIub25EaXNjb25uZWN0KCk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjX3JlbW92ZUZyb21RdWV1ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgcmVtb3ZlIHN5bmNocm9uaXphdGlvbnMgZnJvbSBxdWV1ZScsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0NCcsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Nid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0Nyd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0OCd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNScsIHtyZXF1ZXN0SWQ6ICd0ZXN0OSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0MTAnLCBpbnN0YW5jZUluZGV4OiAwfSk7XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDUzMDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgNik7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDgnfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0MTAnLCBpbnN0YW5jZUluZGV4OiAwfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0Nyd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQ1Jywge3JlcXVlc3RJZDogJ3Rlc3Q5J30pO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNfcmVtb3ZlT2xkU3luY0lkc0pvYn1cbiAgICovXG4gIGl0KCdzaG91bGQgcmVtb3ZlIGV4cGlyZWQgc3luY2hyb25pemF0aW9ucyBmcm9tIHF1ZXVlJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q0J30pO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDgwMDApO1xuICAgICAgdGhyb3R0bGVyLnVwZGF0ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgICAgdGhyb3R0bGVyLnVwZGF0ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MicpO1xuICAgIH1cbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNScsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAgICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYyg4MDAwKTtcbiAgICAgIHRocm90dGxlci51cGRhdGVTeW5jaHJvbml6YXRpb25JZCgndGVzdDEnKTtcbiAgICAgIHRocm90dGxlci51cGRhdGVTeW5jaHJvbml6YXRpb25JZCgndGVzdDInKTtcbiAgICB9XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDMzMDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMyk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDUnLCB7cmVxdWVzdElkOiAndGVzdDUnfSk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIG5vdCBnZXQgcXVldWUgc3R1Y2sgZHVlIHRvIGFwcCBzeW5jaHJvbml6YXRpb25zIGxpbWl0JywgYXN5bmMgKCkgPT4ge1xuICAgIHRocm90dGxlci5fY2xpZW50LnNvY2tldEluc3RhbmNlcyA9IFt7c3luY2hyb25pemF0aW9uVGhyb3R0bGVyOiB7c3luY2hyb25pemluZ0FjY291bnRzOiBbXG4gICAgICAnYWNjb3VudElkMjEnLCAnYWNjb3VudElkMjInLCAnYWNjb3VudElkMjMnLCAnYWNjb3VudElkMjQnLCAnYWNjb3VudElkMjUnLCAnYWNjb3VudElkMjYnLFxuICAgICAgJ2FjY291bnRJZDI3JywgJ2FjY291bnRJZDI4JywgJ2FjY291bnRJZDI5JywgJ2FjY291bnRJZDIxMCcsICdhY2NvdW50SWQyMTEnLCAnYWNjb3VudElkMjEyJywgXG4gICAgICAnYWNjb3VudElkMjEzJywgJ2FjY291bnRJZDIxNCcsICdhY2NvdW50SWQyMTUnXX19LCB7c3luY2hyb25pemF0aW9uVGhyb3R0bGVyOiB0aHJvdHRsZXJ9XTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoNTAwMCk7XG4gICAgc2lub24uYXNzZXJ0Lm5vdENhbGxlZCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QpO1xuICAgIHRocm90dGxlci5fY2xpZW50LnNvY2tldEluc3RhbmNlc1swXS5zeW5jaHJvbml6YXRpb25UaHJvdHRsZXIuc3luY2hyb25pemluZ0FjY291bnRzID0gXG4gICAgICB0aHJvdHRsZXIuX2NsaWVudC5zb2NrZXRJbnN0YW5jZXNbMF0uc3luY2hyb25pemF0aW9uVGhyb3R0bGVyLnN5bmNocm9uaXppbmdBY2NvdW50cy5zbGljZSgxKTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoNTAwMCk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDEpO1xuICAgIHRocm90dGxlci5fY2xpZW50LnNvY2tldEluc3RhbmNlc1swXS5zeW5jaHJvbml6YXRpb25UaHJvdHRsZXIuc3luY2hyb25pemluZ0FjY291bnRzID0gXG4gICAgICB0aHJvdHRsZXIuX2NsaWVudC5zb2NrZXRJbnN0YW5jZXNbMF0uc3luY2hyb25pemF0aW9uVGhyb3R0bGVyLnN5bmNocm9uaXppbmdBY2NvdW50cy5zbGljZSgxKTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoNTAwMCk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDIpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNyZW1vdmVTeW5jaHJvbml6YXRpb25JZH1cbiAgICovXG4gIGl0KCdzaG91bGQgbm90IHNraXAgcXVldWUgaXRlbXMgd2hlbiBzeW5jaHJvbml6YXRpb24gaWQgaXMgcmVtb3ZlZCcsIGFzeW5jICgpID0+IHtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0NCd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNScsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoMjAwMCk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MycpO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYygyMDAwKTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QxJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MicpO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYygyMDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgNCk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3JlbW92ZUlkQnlQYXJhbWV0ZXJzfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCByZW1vdmUgaWQgYnkgcGFyYW1ldGVycycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0MicsIGluc3RhbmNlSW5kZXg6IDAsIGhvc3Q6ICdwcy1tcGEtMCd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0NCcsIGluc3RhbmNlSW5kZXg6IDEsIGhvc3Q6ICdwcy1tcGEtMSd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0NScsIGluc3RhbmNlSW5kZXg6IDAsIGhvc3Q6ICdwcy1tcGEtMid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0Nid9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDUwKSk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZUlkQnlQYXJhbWV0ZXJzKCdhY2NvdW50SWQyJywgMCwgJ3BzLW1wYS0wJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZUlkQnlQYXJhbWV0ZXJzKCdhY2NvdW50SWQyJywgMSwgJ3BzLW1wYS0xJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgNTApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDUnLCBpbnN0YW5jZUluZGV4OiAwLFxuICAgICAgaG9zdDogJ3BzLW1wYS0yJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCA0KTtcbiAgfSk7XG5cbn0pOyJdfQ==